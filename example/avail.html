<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>avail() examples</title>
<style>
</style>

<script type='text/javascript'>

    testData = {
        "test1": {
            "name": "Simple Object Tests",
            "a": {
                "name": "Bob",
                "age": 30,
                "married": true
            },
            "b": {
                "name": "Jenny",
                "age": 28,
                "married": true
            },
            "c": {
                "name": "Mike",
                "age": 12,
                "married": false
            }
        },
        "test2": {
            "name": "Array Tests",
            "anArray": [
                {
                    "item": "hats",
                    "qty": 2
                },
                {
                    "item": "coats",
                    "qty": 4
                },
                {
                    "item": "backpacks",
                    "qty": 3
                }
            ]
        },
        "test3": {
            "name": "Deep Object Test",
            "level1": {
                "level2": {
                    "level3": [
                        {
                            "deep": "deep 1",
                            "deeper": "deeper 1",
                            "deepest": "deepest 1"
                        },
                        {
                            "deep": "deep 2",
                            "deeper": "deeper 2",
                            "deepest": "deepest 2"
                        },
                        {
                            "deep": "deep 3",
                            "deeper": "deeper 3",
                            "deepest": "deepest 3"
                        }
                    ]
                }
            }
        }
    }



function avail(obj, is) {
        var bracketMatch = new RegExp(/\[(.*?)\]/g);
        if (typeof is == 'string') { // if the 'is' agrument is a string. turn it into bracket notation
                members = is.split('.'); // create an array on .
                for (i = 0; i < members.length; i++) { // iterate over the array members
                        if (members[i].indexOf('[') != -1) { // 		if the member has a bracket

                                arrA = members.slice(0, i); // split the array
                                arrC = members.slice(i + 1);

                                startIndex = members[i].indexOf('['); // get first bracket index
                                partOne = members[i].substring(0, startIndex); // and pull off the object name
                                tmp = members[i].match(bracketMatch); // the, get an array of bracket groups

                                arrB = [partOne]; // create a new array starting with the object name
                                for (j = 0; j < tmp.length; j++) { // iterate over the bracketed members
                                        if (Number(tmp[j])) { // if a member is a number,
                                                arrB.push(Number(tmp[j])); // push it as a number (numeric indices)
                                        } else { // otherwise
                                                arrB.push(tmp[j].substring(1, tmp[j].length - 1)); // add it as a string (minus the brackets)
                                        }
                                }
                                members = arrA.concat(arrB).concat(arrC); // put the members array back together
                        }
                }
                return avail(obj, members); // and pass it to the function
        } else if (is.length == 0) { // if 'is' is empty, then this is the final object
                return obj; // so return it
        } else {
                try {
                        tmp = obj[is[0]]; // try to get the next object part
                } catch (err) { // catch the error if it doesnt exist
                        return null; // and return null
                }
                return avail(tmp, is.slice(1)); // if it does exist, slice the array and pass it on.
        }
}

alert(avail(testData, 'test1.name');

</script>

</head>
<body>
<h1>avail() examples</h1>



</body>
</html>
